
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Mesh generation from a 2D gridded point set with a cavity</title><meta name="generator" content="MATLAB 8.0"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2014-11-27"><meta name="DC.source" content="Concave_mesh_grid_2D.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, tt, code { font-size:12px; }
pre { margin:0px 0px 20px; }
pre.error { color:red; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>Mesh generation from a 2D gridded point set with a cavity</h1><!--introduction--><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">Introduction</a></li><li><a href="#2">Initial data</a></li><li><a href="#8">Processing</a></li><li><a href="#13">Plots</a></li><li><a href="#15">Contact author</a></li></ul></div><h2>Introduction<a name="1"></a></h2><p>In this example, a 2-dimensional point set is given, which has an internal cavity. The points form a uniform grid. The idea for the concave mesh creation is to create initially the Delaunay triangulation of the point set and afterwards delete from the mesh the simplices with edge lengths larger than a specified value.</p><h2>Initial data<a name="2"></a></h2><p>Set the random number generator.</p><pre class="codeinput">rng(1);
</pre><p>Set the dimension of the problem.</p><pre class="codeinput">d=2;
</pre><p>Define the point set. Create a square with side length equal to 1 containing gridded mesh.</p><pre class="codeinput">[X,Y]=meshgrid(0:0.1:1);
points=[X(:),Y(:)];
</pre><p>Delete the points at the internal cavity.</p><pre class="codeinput">points((points(:,1)&gt;0.5 &amp; points(:,2)&gt;0.2 &amp; points(:,2)&lt;0.8),:)=[];
</pre><p>Make small perturbations to the point coordinates to avoid numerical instabilities.</p><pre class="codeinput">points=points+0.001*rand(size(points));
</pre><p>Plot the points defining the region the concave hull of which is to be extracted.</p><pre class="codeinput">figure(<span class="string">'Name'</span>,<span class="string">'Point set'</span>,<span class="string">'NumberTitle'</span>,<span class="string">'off'</span>)
scatter(points(:,1),points(:,2),<span class="keyword">...</span>
    <span class="string">'marker'</span>,<span class="string">'o'</span>,<span class="string">'MarkerEdgeColor'</span>,[0 0 1],<span class="string">'LineWidth'</span>,2)
xlabel(<span class="string">'x'</span>,<span class="string">'FontSize'</span>,13);
ylabel(<span class="string">'y'</span>,<span class="string">'FontSize'</span>,13);
title(<span class="string">'Point set'</span>,<span class="string">'FontSize'</span>,13)
axis <span class="string">equal</span>
</pre><img vspace="5" hspace="5" src="Concave_mesh_grid_2D_01.png" alt=""> <h2>Processing<a name="8"></a></h2><p>Find the Delaunay triangulation of the point set.</p><pre class="codeinput">DT=delaunay_nd(points);
</pre><p>Find the squared lengths of the edges of each simplex in the mesh.</p><pre class="codeinput">edgelength=zeros(size(DT));
<span class="keyword">for</span> i=1:size(DT,2)
    j=i+1;
    <span class="keyword">if</span> j&gt;size(DT,2)
        j=j-size(DT,2);
    <span class="keyword">end</span>
    edgevec=points(DT(:,i),:)-points(DT(:,j),:);
    edgelength(:,i)=sum(edgevec.^2,2);
<span class="keyword">end</span>
</pre><p>Find the simplices with squared edge lengths larger than <img src="Concave_mesh_grid_2D_eq44246.png" alt="$0.03$">.</p><pre class="codeinput">sim2del1=any(edgelength&gt;0.03,2);
</pre><p>Find the simplices with squared edge length lower than <img src="Concave_mesh_grid_2D_eq50351.png" alt="$0.001$">. These are created due to the random permutations performed at the initial point set. If no perturbations are performed at the initial data, there is no need for this step.</p><pre class="codeinput">sim2del2=any(edgelength&lt;0.009,2);
</pre><p>Retain the remaining simplices.</p><pre class="codeinput">DT2=DT(~(sim2del1 | sim2del2),:);
</pre><h2>Plots<a name="13"></a></h2><p>Plot the mesh of the point set with the cavity.</p><pre class="codeinput">figure(<span class="string">'Name'</span>,<span class="string">'Mesh including cavity'</span>,<span class="string">'NumberTitle'</span>,<span class="string">'off'</span>)
patch(<span class="string">'Faces'</span>,DT,<span class="string">'Vertices'</span>,points,<span class="keyword">...</span>
    <span class="string">'FaceColor'</span>,[1 0.5 0],<span class="string">'EdgeColor'</span>,[0 0 1]);
xlabel(<span class="string">'x'</span>,<span class="string">'FontSize'</span>,13);
ylabel(<span class="string">'y'</span>,<span class="string">'FontSize'</span>,13);
title(<span class="string">'Mesh including cavity'</span>,<span class="string">'FontSize'</span>,13)
</pre><img vspace="5" hspace="5" src="Concave_mesh_grid_2D_02.png" alt=""> <p>Plot the mesh of the point set without the cavity.</p><pre class="codeinput">figure(<span class="string">'Name'</span>,<span class="string">'Mesh excluding cavity'</span>,<span class="string">'NumberTitle'</span>,<span class="string">'off'</span>)
patch(<span class="string">'Faces'</span>,DT2,<span class="string">'Vertices'</span>,points,<span class="keyword">...</span>
    <span class="string">'FaceColor'</span>,[1 0.5 0],<span class="string">'EdgeColor'</span>,[0 0 1]);
xlabel(<span class="string">'x'</span>,<span class="string">'FontSize'</span>,13);
ylabel(<span class="string">'y'</span>,<span class="string">'FontSize'</span>,13);
title(<span class="string">'Mesh excluding cavity'</span>,<span class="string">'FontSize'</span>,13)
</pre><img vspace="5" hspace="5" src="Concave_mesh_grid_2D_03.png" alt=""> <h2>Contact author<a name="15"></a></h2><pre>(c) 2014 by George Papazafeiropoulos
First Lieutenant, Infrastructure Engineer, Hellenic Air Force
Civil Engineer, M.Sc., Ph.D. candidate, NTUA</pre><p>Email: <a href="mailto:gpapazafeiropoulos@yahoo.gr">gpapazafeiropoulos@yahoo.gr</a></p><p>Website: <a href="http://users.ntua.gr/gpapazaf/">http://users.ntua.gr/gpapazaf/</a></p><p class="footer"><br><a href="http://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2012b</a><br></p></div><!--
##### SOURCE BEGIN #####
%% Mesh generation from a 2D gridded point set with a cavity

%% Introduction
% In this example, a 2-dimensional point set is given, which has an
% internal cavity. The points form a uniform grid. The idea for the concave
% mesh creation is to create initially the Delaunay triangulation of the
% point set and afterwards delete from the mesh the simplices with edge
% lengths larger than a specified value.

%% Initial data
% Set the random number generator.
rng(1);
%%
% Set the dimension of the problem.
d=2;
%% 
% Define the point set. Create a square with side length equal to 1
% containing gridded mesh.
[X,Y]=meshgrid(0:0.1:1);
points=[X(:),Y(:)];
%%
% Delete the points at the internal cavity.
points((points(:,1)>0.5 & points(:,2)>0.2 & points(:,2)<0.8),:)=[];
%%
% Make small perturbations to the point coordinates to avoid numerical
% instabilities.
points=points+0.001*rand(size(points));
%%
% Plot the points defining the region the concave hull of which is to be
% extracted.
figure('Name','Point set','NumberTitle','off')
scatter(points(:,1),points(:,2),...
    'marker','o','MarkerEdgeColor',[0 0 1],'LineWidth',2)
xlabel('x','FontSize',13);
ylabel('y','FontSize',13);
title('Point set','FontSize',13)
axis equal

%% Processing
% Find the Delaunay triangulation of the point set.
DT=delaunay_nd(points);
%%
% Find the squared lengths of the edges of each simplex in the mesh.
edgelength=zeros(size(DT));
for i=1:size(DT,2)
    j=i+1;
    if j>size(DT,2)
        j=j-size(DT,2);
    end
    edgevec=points(DT(:,i),:)-points(DT(:,j),:);
    edgelength(:,i)=sum(edgevec.^2,2);
end
%%
% Find the simplices with squared edge lengths larger than $0.03$.
sim2del1=any(edgelength>0.03,2);
%%
% Find the simplices with squared edge length lower than $0.001$. These are
% created due to the random permutations performed at the initial point
% set. If no perturbations are performed at the initial data, there is no
% need for this step.
sim2del2=any(edgelength<0.009,2);
%%
% Retain the remaining simplices.
DT2=DT(~(sim2del1 | sim2del2),:);

%% Plots
% Plot the mesh of the point set with the cavity.
figure('Name','Mesh including cavity','NumberTitle','off')
patch('Faces',DT,'Vertices',points,...
    'FaceColor',[1 0.5 0],'EdgeColor',[0 0 1]);
xlabel('x','FontSize',13);
ylabel('y','FontSize',13);
title('Mesh including cavity','FontSize',13)

%%
% Plot the mesh of the point set without the cavity.
figure('Name','Mesh excluding cavity','NumberTitle','off')
patch('Faces',DT2,'Vertices',points,...
    'FaceColor',[1 0.5 0],'EdgeColor',[0 0 1]);
xlabel('x','FontSize',13);
ylabel('y','FontSize',13);
title('Mesh excluding cavity','FontSize',13)

%% Contact author
%
%  (c) 2014 by George Papazafeiropoulos
%  First Lieutenant, Infrastructure Engineer, Hellenic Air Force
%  Civil Engineer, M.Sc., Ph.D. candidate, NTUA
%
% Email: gpapazafeiropoulos@yahoo.gr
%
% Website: http://users.ntua.gr/gpapazaf/
%


##### SOURCE END #####
--></body></html>